---
layout: post
title: Completely Distributed Peer-Peer Load sharing
---

>The Problem statement

Lets define the problem first.We have 'n' resources R1,R2,R3....Rn which can be any of 'k' type RT1,RT2,RT3...RTk which arrives as a stream of events. The stream of events are the CRUD operation on these resources. Each of the events are idempotent and self contained. They carry all the information needed to get processsed. The problem is to build a completely distributed peer-peer load sharing system among the processing nodes.

<b>Constraints</b>

<p>

The resources can arrive in anyorder of any type.
The same resource can arrive one after the other in the queue.
The final update of the resource has to be persistent.
The underlying processing nodes should be scalable up/down.
The processing Nodes can go down any time.
The processing nodes should be stateless.

</p>

Note that the processing nodes are all running and pulling events from the queue parallelly.

> Solutions

> Single queue multiple processing nodes:

![Image1]({{ site.url }}/assets/p2p/p2p1.png)

The simplest solution is to have a single queue and all the nodes pull events from the queue. The only problem with this approach is if there is same resource side by side in the queue, then multiple nodes will pick and process these resources. The final outcome of the processing is dependent on the order in which the nodes process the resource.